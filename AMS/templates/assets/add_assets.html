{% extends 'base.html' %}

{% block title %}资产管理系统—资产信息添加{% endblock title %}

{% block content %}
        <!-- Start #content -->
        <div id="content">
            <!-- Start .content-wrapper -->
            <div class="content-wrapper">
                <div class="row">
                    <!-- Start .row -->
                    <!-- Start .page-header -->
                    <div class="col-lg-12 heading">
                        <h1 class="page-header"><i class="im-checkbox-checked"></i> 添加资产详细信息</h1>
                        <!-- Start .bredcrumb -->
                        <ul id="crumb" class="breadcrumb">
                        </ul>
                        <!-- End .breadcrumb -->
                        <!-- Start .option-buttons -->

                        <!-- End .option-buttons -->
                    </div>
                    <!-- End .page-header -->
                </div>
                <!-- End .row -->
                <!-- Page start here ( usual with .row ) -->
                <div class="outlet">
                    <!-- Start .outlet -->
                    <div class="row">
                        <!-- Start .row -->
                        <div class="col-lg-12">
                            <!-- Start col-lg-12 -->
                            <div class="panel panel-default toggle">
                                <!-- Start .panel -->
                                <div class="panel-heading">
                                    <h3 class="panel-title">添加资产详细信息</h3>
                                </div>
                                <div class="panel-body">
                                    <form method="post" class="form-horizontal group-border hover-stripped" role="form" id="assets" enctype="multipart/form-data">
                                        <div class="form-group">
                                            <label class="col-lg-2 control-label">资产名称</label>
                                            <div class="col-lg-10">
                                                <input type="text" class="form-control required" name="name">
                                            </div>
                                        </div>

                                        <div class="form-group">
                                            <label class="col-lg-2 control-label">所属分类</label>
                                            <div class="col-lg-10">
                                                <select class="form-control select2" id="first_category" name="category">
                                                    <option value="">请选择分类</option>
                                                    {% for category1 in category1s %}
                                                    <optgroup label="{{ category1.name }}">
                                                        {% for category2 in category2s %}
                                                            {% if category2.parent_category_id == category1.id %}
                                                        <option value="{{ category2.id }}">{{ category2.name }}</option>
                                                            {% endif %}
                                                        {% endfor %}
                                                    {% endfor %}
{#                                                        <option value="HI">Hawaii</option>#}
{#                                                    </optgroup>#}

                                                </select>
                                            </div>
                                        </div>

                                        <!-- End .form-group  -->
                                        <div class="form-group">
                                            <label class="col-lg-2 control-label">品牌名称</label>
                                            <div class="col-lg-10">
                                                <input type="text" class="form-control" name="brand" placeholder="">
                                            </div>
                                        </div>
                                        <!-- End .form-group  -->
                                        <div class="form-group">
                                            <label class="col-lg-2 control-label">型号</label>
                                            <div class="col-lg-10">
                                                <input type="text" class="form-control" name="assets_type" placeholder="">
                                            </div>
                                        </div>
                                        <!-- End .form-group  -->
                                        <div class="form-group">
                                            <label class="col-lg-2 control-label">资产唯一编号</label>
                                            <div class="col-lg-10">
                                                <input type="text" class="form-control" id="maxLenght" name="assets_sn" placeholder="">
                                            </div>
                                        </div>
                                        <!-- End .form-group  -->
                                         <div class="form-group">
                                            <label class="col-lg-2 control-label">资产状态</label>
                                            <div class="col-lg-10">
                                                <select class="form-control select2" name="status" id="select2">

                                                        <option value="IDLE">闲置</option>
                                                        <option value="IN_USE">在用</option>
                                                        <option value="SCRAP">报废</option>
                                                        <option value="NOT_HAVE">暂无，需购买</option>


                                                </select>
                                            </div>
                                        </div>
                                        <div class="form-group">
                                            <label class="col-lg-2 control-label">资产价格</label>
                                            <div class="col-lg-10">
                                                <input type="text" class="form-control" id="" name="price" placeholder="">
                                            </div>
                                        </div>
                                        <!-- End .form-group  -->
                                        <div class="form-group">
                                            <label class="col-lg-2 control-label">资产剩余可用</label>
                                            <div class="col-lg-10">
                                                <input type="text" class="form-control" id="url" name="nums" placeholder="">
                                            </div>
                                        </div>
                                        <!-- End .form-group  -->

                                        <div class="form-group">
                                            <div class="col-lg-offset-2">
                                                <button class="btn btn-default ml15" type="submit">提交</button>
                                            </div>
                                        </div>
                                        <!-- End .form-group  -->
                                    {% csrf_token %}
                                    </form>
                                </div>
                            </div>
                            <!-- End .panel -->
                        </div>
                        <!-- End col-lg-12 -->
                    </div>
                    <!-- End .row -->
                    <!-- Page End here -->
                </div>
                <!-- End .outlet -->
            </div>
            <!-- End .content-wrapper -->
            <div class="clearfix"></div>
        </div>
        <!-- End #content -->
{% endblock content %}

{% block endjs %}
        <script src="/static/assets/plugins/core/moment/moment.min.js"></script>
        <script src="/static/assets/plugins/charts/sparklines/jquery.sparkline.js"></script>
        <script src="/static/assets/plugins/charts/pie-chart/jquery.easy-pie-chart.js"></script>
        <script src="/static/assets/plugins/forms/icheck/jquery.icheck.js"></script>
        <script src="/static/assets/plugins/forms/tags/jquery.tagsinput.min.js"></script>
        <script src="/static/assets/plugins/forms/tinymce/tinymce.min.js"></script>
        <script src="/static/assets/plugins/forms/switch/jquery.onoff.min.js"></script>
        <script src="/static/assets/plugins/forms/maxlength/bootstrap-maxlength.js"></script>
        <script src="/static/assets/plugins/forms/bootstrap-filestyle/bootstrap-filestyle.js"></script>
        <script src="/static/assets/plugins/forms/color-picker/spectrum.js"></script>
        <script src="/static/assets/plugins/forms/daterangepicker/daterangepicker.js"></script>
        <script src="/static/assets/plugins/forms/datetimepicker/bootstrap-datetimepicker.min.js"></script>
        <script src="/static/assets/plugins/forms/globalize/globalize.js"></script>
        <script src="/static/assets/plugins/forms/maskedinput/jquery.maskedinput.js"></script>
        <script src="/static/assets/plugins/forms/select2/select2.js"></script>
        <script src="/static/assets/plugins/forms/dual-list-box/jquery.bootstrap-duallistbox.js"></script>
        <script src="/static/assets/plugins/forms/password/jquery-passy.js"></script>
        <script src="/static/assets/plugins/forms/checkall/jquery.checkAll.js"></script>
        <script src="/static/assets/plugins/forms/validation/jquery.validate.js"></script>
        <script src="/static/assets/plugins/forms/validation/additional-methods.min.js"></script>
        <script src="/static/assets/plugins/misc/highlight/highlight.pack.js"></script>
        <script src="/static/assets/plugins/misc/countTo/jquery.countTo.js"></script>
        <script src="/static/assets/js/jquery.sprFlat.js"></script>
        <script src="/static/assets/js/app.js"></script>
        <script src="/static/assets/js/pages/form-validation.js"></script>

    <script type="text/javascript">
    $(document).ready(function() {
    $("#assets").submit(function(){
        {#alert('11111');#}

                $.ajax({
                        cache: false,
                        type: "POST",
                        url: '{% url 'assets:add_assets' %}',
                        data: $('#assets').serialize(),
                        async: true,
                        beforeSend: function (xhr, settings) {
                            xhr.setRequestHeader("X-CSRFToken","{{ csrf_token }}");
                            {#alert('3333');#}
                        },
                        success: function (data) {
                            {#alert('2222');#}
                            if (data.status == 'fail') {
                                if (data.msg == '资产唯一编号重复，请重新录入') {
                                    alert('保存失败');
                                    window.location.href = "{% url 'assets:assets_add' %}";
                                }
                                else {
                                    alert(data.msg)
                                }
                            }
                            else if (data.status == 'success') {
                                alert('资产信息保存成功');
                                window.location.reload();
                            }
                        }
                    })
		})
    })
    </script>
{% endblock endjs %}